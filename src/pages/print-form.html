<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy"
        content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; font-src 'self'; img-src 'self' data:; connect-src 'self';">
    <title>Print Form - Noor & Sons Tailors</title>
    <link rel="stylesheet" href="../css/bootstrap.min.css">
    <link rel="stylesheet" href="../css/print-form.css">
    
</head>

<body>
    <!-- Print Controls -->
    <div class="print-controls no-print">
        <button class="print-btn" onclick="window.print()">ğŸ–¨ï¸ Print</button>
    </div> <!-- Print Form Layout -->
    <div class="print-form">
        <!-- Print Header with Logos -->
        <div class="print-header">
            <img src="../assets/img/logo-pic.png" alt="Noor & Sons Logo" class="logo-left">
            <div class="shop-info">
                <h2>Noor & Sons Tailors And Fabrics</h2>
                <p>We offer you stitching of your choice</p>
            </div>
            <div class="logo-right-container">
                <img src="../assets/img/coat_logo-pic.png" alt="Coat Logo" class="logo-right">
                <img src="../assets/img/Needle-logo.jpg" alt="Needle Logo" class="logo-right-bottom">
            </div>
        </div>

        <!-- Customer Info Section -->
        <div class="customer-info">
            <div class="info-row">
                <div class="info-item">
                    <label class="info-label">Code Number</label>
                    <div class="info-value" id="print-code-number"></div>
                </div>
                <div class="info-item">
                    <label class="info-label">Order Date</label>
                    <div class="info-value" id="print-order-date"></div>
                </div>
                <div class="info-item">
                    <label class="info-label">Return Date</label>
                    <div class="info-value" id="print-return-date"></div>
                </div>
            </div>

            <div class="info-row">
                <div class="info-item">
                    <label class="info-label">Name</label>
                    <div class="info-value" id="print-name"></div>
                </div>
                <div class="info-item">
                    <label class="info-label">Age</label>
                    <div class="info-value" id="print-age"></div>
                </div>
                <div class="info-item">
                    <label class="info-label">Cell Number</label>
                    <div class="info-value" id="print-cell-number"></div>
                </div>
            </div>

            <div class="info-row">
                <div class="info-item grid-span-3">
                    <label class="info-label">Address</label>
                    <div class="info-value" id="print-address"></div>
                </div>
            </div>
        </div> <!-- Cutting Section -->
        <div class="cutting-section">
            <div class="cutting-item">
                <label>Cutting No:</label>
                <div class="cutting-value" id="print-cutting-no"></div>
            </div>
            <div class="cutting-item">
                <label>Quantity:</label>
                <div class="cutting-value" id="print-quantity"></div>
            </div>
            <div class="cutting-item">
                <label>Enter by <span id="print-entered-by">Abubakkar</span></label>
            </div>
            <div class="garment-type">Ø´Ù„ÙˆØ§Ø± Ù‚Ù…ÛŒØµ</div>
        </div> <!-- Qameez Section -->
        <div class="measurement-section" id="print-qameez-section">
            <div class="section-title">Ù‚Ù…ÛŒØµ</div>
            <div class="qameez-two-column-grid">
                <!-- Column 1 -->
                <div class="qameez-column-1">
                    <div class="qameez-measure-item">
                        <span class="qameez-label">Ù„Ù…Ø¨Ø§Ø¦ÛŒ</span>
                        <span class="qameez-value" id="qameez-lambai"></span>
                        <span class="qameez-style" id="qameez-daman-style"></span>
                    </div>
                    <div class="qameez-measure-item">
                        <span class="qameez-label">Ø¢Ø³ØªÛŒÙ†</span>
                        <span class="qameez-value" id="qameez-asteen"></span>
                        <span class="qameez-style" id="qameez-sleeve-style"></span>
                    </div>
                    <div class="qameez-measure-item">
                        <span class="qameez-label">ØªÛŒØ±Ø§</span>
                        <span class="qameez-value" id="qameez-tera"></span>
                    </div>
                    <div class="qameez-measure-item">
                        <span class="qameez-label">Ø¨ÛŒÙ† / Ú©Ø§Ù„Ø±</span>
                        <span class="qameez-collar-combined" id="qameez-collar-combined"></span>
                    </div>
                    <div class="qameez-measure-item">
                        <span class="qameez-label">Ú†Ú¾Ø§ØªÛŒ</span>
                        <span class="qameez-value" id="qameez-chati"></span>
                    </div>
                    <div class="qameez-measure-item">
                        <span class="qameez-label">Ú©Ù…Ø±</span>
                        <span class="qameez-value" id="qameez-kamar"></span>
                    </div>
                    <div class="qameez-measure-item">
                        <span class="qameez-label">Ú¯ÛŒØ±Û</span>
                        <span class="qameez-value" id="qameez-gira"></span>
                    </div>
                    <div class="qameez-measure-item">
                        <span class="qameez-label">Ù…ÙˆÚ‘Û</span>
                        <span class="qameez-value" id="qameez-moza"></span>
                    </div>
                    <div class="qameez-measure-item">
                        <span class="qameez-label">Ø´ÙˆÙ„ÚˆØ±</span>
                        <span class="qameez-value" id="qameez-shoulder"></span>
                    </div>
                </div> <!-- Column 2 -->
                <div class="qameez-column-2">
                    <div class="qameez-measure-item">
                        <span class="qameez-label">Ù¾Ø§Ú©Ù¹</span>
                        <span class="qameez-value" id="qameez-pocket-type"></span>
                    </div>
                    <div class="qameez-measure-item">
                        <span class="qameez-label">ÙØ±Ù†Ù¹ Ù¾Ø§Ú©Ù¹</span>
                        <span class="qameez-style" id="qameez-front-pocket-style"></span>
                        <span class="qameez-value" id="qameez-front-pocket-size"></span>
                    </div>
                    <div class="qameez-measure-item">
                        <span class="qameez-label" id="qameez-cuff-plate-label">Ù¾Ù„ÛŒÙ¹ ÙˆØ§Ù„Ø§ Ú©Ù</span>
                        <span class="qameez-style" id="qameez-cuff-style"></span>
                    </div>
                    <div class="qameez-measure-item">
                        <span class="qameez-label">Ú©Ù Ú©Ø§Ø¬</span>
                        <span class="qameez-value" id="qameez-cuff-kaj"></span>
                    </div>
                    <div class="qameez-measure-item">
                        <span class="qameez-label">Ú†Ú© Ù¾Ù¹ÛŒ</span>
                        <span class="qameez-value" id="qameez-chak-patti"></span>
                    </div>
                    <div class="qameez-measure-item">
                        <span class="qameez-label">Ú†Ú© Ù¾Ù¹ÛŒ Ú©Ø§Ø¬</span>
                        <span class="qameez-value" id="qameez-chak-patti-kaj"></span>
                    </div>
                    <div class="qameez-measure-item">
                        <span class="qameez-label">Ù¾Ù¹ÛŒ</span>
                        <span class="qameez-value" id="qameez-patti"></span>
                    </div>
                    <div class="qameez-measure-item">
                        <span class="qameez-label">Ù¾Ù¹ÛŒ Ú†ÙˆÚ‘Ø§Ø¦ÛŒ</span>
                        <span class="qameez-value" id="qameez-patti-churai"></span>
                    </div>
                </div>
            </div>

            <!-- Grouped Options Section -->
            <div class="qameez-grouped-options">
                <div class="grouped-option-item">
                    <span class="option-label">Ø¹Ø§Ù… Ø±Ù†Ú¯ Ø¨Ù¹Ù†</span>
                    <span class="option-value" id="qameez-button-color-grouped"></span>
                </div>
                <div class="grouped-option-item">
                    <span class="option-label">Ø¨Ù¹Ù†</span>
                    <span class="option-value" id="qameez-button-size-grouped"></span>
                </div>
                <div class="grouped-option-item">
                    <span class="option-label">Ø³Ø§Ø¯Û Ø³Ù„Ø§Ø¦ÛŒ</span>
                    <span class="option-value" id="qameez-silai-grouped"></span>
                </div>
            </div>
        </div>

        <!-- Separator Line -->
        <div class="separator"></div> <!-- Shalwar Section -->
        <div class="measurement-section" id="print-shalwar-section">
            <div class="shalwar-two-column-grid">
                <!-- Column 1 -->
                <div class="shalwar-column-1">
                    <div class="shalwar-measure-item">
                        <span class="shalwar-label">Ø´Ù„ÙˆØ§Ø± Ù„Ù…Ø¨Ø§Ø¦ÛŒ</span>
                        <span class="shalwar-value" id="shalwar-lambai"></span>
                    </div>
                    <div class="shalwar-measure-item">
                        <span class="shalwar-label">Ù¾Ø§Ù†Ú†Û</span>
                        <span class="shalwar-value" id="shalwar-pacha"></span>
                    </div>
                    <div class="shalwar-measure-item">
                        <span class="shalwar-label">ÛÙ¾</span>
                        <span class="shalwar-value" id="shalwar-hip"></span>
                    </div>
                </div>

                <!-- Column 2 -->
                <div class="shalwar-column-2">
                    <div class="shalwar-measure-item">
                        <span class="shalwar-label">Ø§Ù†Ø³Ø§ÛŒÚˆ</span>
                        <span class="shalwar-value" id="shalwar-ander"></span>
                    </div>
                    <div class="shalwar-measure-item">
                        <span class="shalwar-label">Ø´Ù„ÙˆØ§Ø± Ù¾Ø§Ú©Ù¹</span>
                        <span class="shalwar-value" id="shalwar-pocket"></span>
                    </div>
                    <div class="shalwar-measure-item">
                        <span class="shalwar-label">Ø´Ù„ÙˆØ§Ø± Ù‚Ø³Ù…</span>
                        <span class="shalwar-value" id="shalwar-type"></span>
                    </div>
                </div>
            </div>
        </div><!-- Extra Demand Section -->
        <div class="extra-demand" id="print-extra-demand-section">
            <div class="extra-demand-label">Ø§ÛŒÚ©Ø³Ù¹Ø±Ø§ ÚˆÛŒÙ…Ø§Ù†Úˆ</div>
            <div class="extra-demand-value" id="print-extra-demand"></div>
        </div>
    </div>

    <!-- Print Controls (hidden during printing) -->
    <div class="print-controls" id="print-controls">
        <button onclick="manualPrint()" class="btn-print">ğŸ–¨ï¸ Print Again</button>
        <button onclick="window.close()" class="btn-close">âœ– Close</button>
    </div>
    <script>
        // Print form functionality with comprehensive error handling
        function loadCustomerDataFromURL() {
            try {
                const urlParams = new URLSearchParams(window.location.search);
                const customerId = urlParams.get('id');

                if (customerId) {
                    const customers = JSON.parse(localStorage.getItem('customers') || '[]');
                    const customer = customers.find(c => (c.id || c._id) === customerId);

                    if (customer) {
                        populatePrintForm(customer);
                        // Auto print after a delay to ensure everything loads
                        setTimeout(() => {
                            window.print();
                        }, 1000);
                    } else {
                        console.error('Customer not found with ID:', customerId);
                        alert('Customer data not found. Please check the customer ID.');
                    }
                } else {
                    console.error('No customer ID provided in URL');
                    alert('No customer ID provided in URL.');
                }
            } catch (error) {
                console.error('Error loading customer data:', error);
                alert('Error loading customer data: ' + error.message);
            }
        }

        function populatePrintForm(customer) {
            try {
                // Helper function to format date
                const formatPrintDate = (dateStr) => {
                    if (!dateStr) return '';
                    try {
                        const date = new Date(dateStr);
                        return date.toLocaleDateString();
                    } catch (e) {
                        return dateStr;
                    }
                };

                // Helper function to check if a field has a value
                const hasValue = (value) => {
                    return value && value.toString().trim() !== '';
                };

                // Helper function to safely set text content
                const safeSetTextContent = (id, value) => {
                    const element = document.getElementById(id);
                    if (element) {
                        element.textContent = value || '';
                    } else {
                        console.warn(`Element with ID '${id}' not found in print form`);
                    }
                };

                // Populate customer info with error handling
                safeSetTextContent('print-code-number', customer.codeNumber);
                safeSetTextContent('print-order-date', formatPrintDate(customer.orderDate));
                safeSetTextContent('print-return-date', formatPrintDate(customer.returnDate));
                safeSetTextContent('print-name', customer.name);
                safeSetTextContent('print-age', customer.age);
                safeSetTextContent('print-cell-number', customer.cellNumber);
                safeSetTextContent('print-address', customer.address);
                safeSetTextContent('print-cutting-no', customer.cuttingNo);
                safeSetTextContent('print-quantity', customer.quantity);
                safeSetTextContent('print-entered-by', customer.enteredBy || 'Abubakkar');

                // Define measurements including collar_measurement
                const qameezMeasurements = [
                    { field: 'lambai', label: 'Ù„Ù…Ø¨Ø§Ø¦ÛŒ' },
                    { field: 'asteen', label: 'Ø¢Ø³ØªÛŒÙ†' },
                    { field: 'tera', label: 'ØªÛŒØ±Ø§' },
                    { field: 'collar_measurement', label: 'Ø¨ÛŒÙ† / Ú©Ø§Ù„Ø± Ù…Ø§Ù¾' },
                    { field: 'chati', label: 'Ú†Ú¾Ø§ØªÛŒ' },
                    { field: 'kamar', label: 'Ú©Ù…Ø±' },
                    { field: 'gira', label: 'Ú¯ÛŒØ±Û' },
                    { field: 'moza', label: 'Ù…ÙˆÚ‘Û' },
                    { field: 'gol_asteen', label: 'Ú¯ÙˆÙ„ Ø¢Ø³ØªÛŒÙ†' },
                    { field: 'collar_type', label: 'Ú©Ø§Ù„Ø± Ù¹Ø§Ø¦Ù¾' },
                    { field: 'collar_style', label: 'Ú©Ø§Ù„Ø± Ø§Ø³Ù¹Ø§Ø¦Ù„' },
                    { field: 'front_pocket_size', label: 'ÙØ±Ù†Ù¹ Ù¾Ø§Ú©Ù¹ Ø³Ø§Ø¦Ø²' },
                    { field: 'double_side_pocket', label: 'ÚˆØ¨Ù„ Ø³Ø§Ø¦ÛŒÚˆ Ù¾Ø§Ú©Ù¹' },
                    { field: 'single_pocket', label: 'Ø³Ù†Ú¯Ù„ Ù¾Ø§Ú©Ù¹' },
                    { field: 'front_pocket', label: 'ÙØ±Ù†Ù¹ Ù¾Ø§Ú©Ù¹' },
                    { field: 'silai', label: 'Ø³Ù„Ø§Ø¦ÛŒ' },
                    { field: 'button_color', label: 'Ø¨Ù¹Ù† Ú©Ø§ Ø±Ù†Ú¯' },
                    { field: 'button', label: 'Ø¨Ù¹Ù†' },
                    { field: 'button_size', label: 'Ø¨Ù¹Ù† Ø³Ø§Ø¦Ø²' },
                    { field: 'cuff_plate', label: 'Ú©Ù Ù¾Ù„ÛŒÙ¹' },
                    { field: 'cuff_style', label: 'Ú©Ù Ø§Ø³Ù¹Ø§Ø¦Ù„' },
                    { field: 'cuff_kaj', label: 'Ú©Ù Ú©Ø§Ø¬' }, { field: 'chak_patti', label: 'Ú†Ú© Ù¾Ù¹ÛŒ' },
                    { field: 'chak_patti_kaj', label: 'Ú†Ú© Ù¾Ù¹ÛŒ Ú©Ø§Ø¬' },
                    { field: 'daman', label: 'Ø¯Ø§Ù…Ù†' },
                    { field: 'shoulder', label: 'Ø´ÙˆÙ„ÚˆØ±' },
                    { field: 'shoulder_style', label: 'Ø´ÙˆÙ„ÚˆØ± Ø§Ø³Ù¹Ø§Ø¦Ù„' },
                    { field: 'sleeve_type', label: 'Ø¢Ø³ØªÛŒÙ† Ú©ÛŒ Ù‚Ø³Ù…' },
                    { field: 'patti', label: 'Ù¾Ù¹ÛŒ' },
                    { field: 'patti_churai', label: 'Ù¾Ù¹ÛŒ Ú†ÙˆÚ‘Ø§Ø¦ÛŒ' }
                ];

                const shalwarMeasurements = [{ field: 'shalwar_lambai', label: 'Ø´Ù„ÙˆØ§Ø± Ù„Ù…Ø¨Ø§Ø¦ÛŒ' },
                { field: 'pacha', label: 'Ù¾Ø§Ù†Ú†Û' },
                { field: 'lib', label: 'ÛÙ¾' },
                { field: 'ander', label: 'Ø§Ù†Ø³Ø§ÛŒÚˆ' },
                { field: 'shalwar_pocket', label: 'Ø´Ù„ÙˆØ§Ø± Ù¾Ø§Ú©Ù¹' },
                { field: 'shalwar_type', label: 'Ø´Ù„ÙˆØ§Ø± Ù‚Ø³Ù…' }
                ];

                // Populate measurements
                const measurements = customer.measurements || {};                // Populate individual qameez fields in the two-column layout with error handling
                safeSetTextContent('qameez-lambai', measurements.lambai);
                safeSetTextContent('qameez-asteen', measurements.asteen);
                safeSetTextContent('qameez-tera', measurements.tera);

                // Populate combined collar field in the format: Ú©Ø§Ù„Ø±Ø§Ù†Ú¯Ù„Ø´ 2 15 Ø¨ÛŒÙ† / Ú©Ø§Ù„Ø±
                const collarParts = [];
                if (measurements.collar_type) collarParts.push(measurements.collar_type);
                if (measurements.collar_measurement) collarParts.push(measurements.collar_measurement);
                if (measurements.collar_ben_width_churai) collarParts.push(measurements.collar_ben_width_churai);
                if (collarParts.length > 0) collarParts.push('Ø¨ÛŒÙ† / Ú©Ø§Ù„Ø±');
                safeSetTextContent('qameez-collar-combined', collarParts.join(' '));

                safeSetTextContent('qameez-chati', measurements.chati);
                safeSetTextContent('qameez-kamar', measurements.kamar);
                safeSetTextContent('qameez-gira', measurements.gira);
                safeSetTextContent('qameez-moza', measurements.moza);
                safeSetTextContent('qameez-shoulder', measurements.shoulder);

                // Populate style fields with error handling
                safeSetTextContent('qameez-daman-style', measurements.daman);
                safeSetTextContent('qameez-sleeve-style', measurements.sleeve_type);
                safeSetTextContent('qameez-collar-style', measurements.collar_style);
                safeSetTextContent('qameez-pocket-type', measurements.single_pocket || measurements.double_side_pocket);
                safeSetTextContent('qameez-front-pocket-style', measurements.front_pocket);
                safeSetTextContent('qameez-front-pocket-size', measurements.front_pocket_size); safeSetTextContent('qameez-silai', measurements.silai);
                safeSetTextContent('qameez-button-color', measurements.button_color);
                safeSetTextContent('qameez-button-size', measurements.button_size);                // Combine button type and button size for qameez-button field
                let buttonCombined = '';
                if (measurements.button && measurements.button !== '') {
                    if (measurements.button_size && measurements.button_size !== '') {
                        buttonCombined = measurements.button_size + ' ' + measurements.button;
                    } else {
                        buttonCombined = measurements.button;
                    }
                } else if (measurements.button_size && measurements.button_size !== '') {
                    buttonCombined = measurements.button_size;
                }
                safeSetTextContent('qameez-button', buttonCombined);

                // Combine cuff style and length with cuff plate prefix
                let cuffCombined = '';
                if (measurements.cuff_style) cuffCombined += measurements.cuff_style;
                if (measurements.cuff_length) cuffCombined += (cuffCombined ? ' ' : '') + measurements.cuff_length;

                // Add cuff plate prefix if available and not "NO"
                if (measurements.cuff_plate && measurements.cuff_plate !== 'NO' && measurements.cuff_plate !== '' && cuffCombined) {
                    cuffCombined = measurements.cuff_plate + ' ' + cuffCombined;
                }

                safeSetTextContent('qameez-cuff-style', cuffCombined); safeSetTextContent('qameez-cuff-kaj', measurements.cuff_kaj); safeSetTextContent('qameez-chak-patti', measurements.chak_patti); safeSetTextContent('qameez-chak-patti-kaj', measurements.chak_patti_kaj);

                // Handle gum_patti prefix for patti field
                let pattiValue = measurements.patti;
                if (measurements.gum_patti === 'Yes' && pattiValue && pattiValue !== 'Ù¾Ù¹ÛŒ') {
                    pattiValue = 'Ú¯Ù… ' + pattiValue;
                }
                safeSetTextContent('qameez-patti', pattiValue);

                safeSetTextContent('qameez-patti-churai', measurements.patti_churai);                // Populate grouped options section
                safeSetTextContent('qameez-button-color-grouped', measurements.button_color);                // Combine button type and size for grouped section
                let buttonGroupedCombined = '';
                if (measurements.button && measurements.button !== '') {
                    if (measurements.button_size && measurements.button_size !== '') {
                        buttonGroupedCombined = measurements.button_size + ' ' + measurements.button;
                    } else {
                        buttonGroupedCombined = measurements.button;
                    }
                } else if (measurements.button_size && measurements.button_size !== '') {
                    buttonGroupedCombined = measurements.button_size;
                }
                safeSetTextContent('qameez-button-size-grouped', buttonGroupedCombined);

                safeSetTextContent('qameez-silai-grouped', measurements.silai);

                // Populate individual shalwar fields in the two-column layout with error handling
                safeSetTextContent('shalwar-lambai', measurements.shalwar_lambai);
                safeSetTextContent('shalwar-pacha', measurements.pacha);
                safeSetTextContent('shalwar-hip', measurements.lib);
                safeSetTextContent('shalwar-ander', measurements.ander);
                safeSetTextContent('shalwar-pocket', measurements.shalwar_pocket);
                safeSetTextContent('shalwar-type', measurements.shalwar_type);

                // Generate Qameez measurements HTML (for dynamic container if needed)
                // Note: We're now using static two-column layout, so this container might not exist
                const qameezContainer = document.getElementById('print-qameez-measurements');
                if (qameezContainer) {
                    qameezContainer.innerHTML = '';

                    qameezMeasurements.forEach(item => {
                        if (hasValue(measurements[item.field])) {
                            const measureItem = document.createElement('div');
                            measureItem.className = 'measure-item';
                            measureItem.innerHTML = `
                                <div class="measure-label">${item.label}</div>
                                <div class="measure-value">${measurements[item.field]}</div>
                            `;
                            qameezContainer.appendChild(measureItem);
                        }
                    });
                }

                // Hide sections if no measurements (with error handling)
                const qameezSection = document.getElementById('print-qameez-section');
                // Check if qameez has any data by looking at the main fields
                const hasQameezData = measurements.lambai || measurements.asteen || measurements.chati || measurements.collar_measurement;
                if (qameezSection) {
                    if (!hasQameezData && (!qameezContainer || qameezContainer.children.length === 0)) {
                        qameezSection.classList.add('hidden');
                    } else {
                        qameezSection.classList.remove('hidden');
                    }
                } const shalwarSection = document.getElementById('print-shalwar-section');
                // Check if shalwar has any data by looking at the main fields
                const hasShalwarData = measurements.shalwar_lambai || measurements.pacha || measurements.lib;
                if (shalwarSection) {
                    if (!hasShalwarData) {
                        shalwarSection.classList.add('hidden');
                    } else {
                        shalwarSection.classList.remove('hidden');
                    }
                }

                // Handle extra demand with error handling
                const extraDemandValue = measurements.extra_demand || '';
                safeSetTextContent('print-extra-demand', extraDemandValue);
                const extraDemandSection = document.getElementById('print-extra-demand-section');
                if (extraDemandSection) {
                    if (extraDemandValue) {
                        extraDemandSection.classList.remove('hidden');
                    } else {
                        extraDemandSection.classList.add('hidden');
                    }
                }

                // Hide measurement fields that are "NO" or empty for print
                hidePrintEmptyFields(measurements);

                // Adjust qameez container height to prevent separator overlap
                adjustQameezContainerHeight();
            } catch (error) {
                console.error('Error populating print form:', error);
                alert('Error loading print data: ' + error.message);
            }
        }        // Function to hide measurement fields that are "NO" or empty for print
        function hidePrintEmptyFields(measurements) {
            try {
                // Get all measurement items in qameez and shalwar sections
                const qameezItems = document.querySelectorAll('.qameez-measure-item');
                const shalwarItems = document.querySelectorAll('.shalwar-measure-item');
                const dynamicItems = document.querySelectorAll('.measure-item');
                const groupedItems = document.querySelectorAll('.grouped-option-item');
                // Process qameez measurement items
                qameezItems.forEach(item => {
                    const valueElement = item.querySelector('.qameez-value');
                    const styleElement = item.querySelector('.qameez-style');
                    const collarElement = item.querySelector('.qameez-collar-combined');

                    if (valueElement) {
                        const value = valueElement.textContent.trim();
                        const styleValue = styleElement ? styleElement.textContent.trim() : '';

                        // Hide if value is empty, "NO", or style is "NO"
                        if (!value || value.toLowerCase() === 'no' || styleValue.toLowerCase() === 'no') {
                            item.classList.add('print-hide-empty');
                        } else {
                            item.classList.remove('print-hide-empty');
                        }
                    } else if (collarElement) {
                        const value = collarElement.textContent.trim();

                        // Hide if collar combined value is empty, just "Ø¨ÛŒÙ† / Ú©Ø§Ù„Ø±" or "NO"
                        if (!value || value === 'Ø¨ÛŒÙ† / Ú©Ø§Ù„Ø±' || value.toLowerCase() === 'no') {
                            item.classList.add('print-hide-empty');
                        } else {
                            item.classList.remove('print-hide-empty');
                        }
                    }
                });

                // Process shalwar measurement items (static layout)
                shalwarItems.forEach(item => {
                    const valueElement = item.querySelector('.shalwar-value');

                    if (valueElement) {
                        const value = valueElement.textContent.trim();

                        // Hide if value is empty or "NO"
                        if (!value || value.toLowerCase() === 'no') {
                            item.classList.add('print-hide-empty');
                        } else {
                            item.classList.remove('print-hide-empty');
                        }
                    }
                });

                // Process dynamic measurement items (if any)
                dynamicItems.forEach(item => {
                    const valueElement = item.querySelector('.measure-value');

                    if (valueElement) {
                        const value = valueElement.textContent.trim();

                        // Hide if value is empty or "NO"
                        if (!value || value.toLowerCase() === 'no') {
                            item.classList.add('print-hide-empty');
                        } else {
                            item.classList.remove('print-hide-empty');
                        }
                    }
                });

                // Process grouped option items
                groupedItems.forEach(item => {
                    const valueElement = item.querySelector('.option-value');

                    if (valueElement) {
                        const value = valueElement.textContent.trim();

                        // Hide if value is empty or "NO"
                        if (!value || value.toLowerCase() === 'no') {
                            item.classList.add('print-hide-empty');
                        } else {
                            item.classList.remove('print-hide-empty');
                        }
                    }
                });

                console.log('Applied print hide rules to measurement fields');
                console.log('Qameez items processed:', qameezItems.length);
                console.log('Shalwar items processed:', shalwarItems.length);
                console.log('Dynamic items processed:', dynamicItems.length);
                console.log('Grouped items processed:', groupedItems.length);
            } catch (error) {
                console.error('Error hiding empty print fields:', error);
            }
        }

        // Function to adjust qameez container height to prevent separator overlap
        function adjustQameezContainerHeight() {
            try {
                const container = document.querySelector('.qameez-two-column-grid');
                const column1 = document.querySelector('.qameez-column-1');
                const column2 = document.querySelector('.qameez-column-2');

                if (container && column1 && column2) {
                    // Get the actual height of both columns
                    const column1Height = column1.offsetHeight;
                    const column2Height = column2.offsetHeight;

                    // Set container height to the taller column plus some padding
                    const maxHeight = Math.max(column1Height, column2Height);
                    container.style.minHeight = (maxHeight + 20) + 'px';

                    console.log('Adjusted qameez container height:', maxHeight + 20, 'px');
                    console.log('Column 1 height:', column1Height, 'px');
                    console.log('Column 2 height:', column2Height, 'px');
                }
            } catch (error) {
                console.error('Error adjusting qameez container height:', error);
            }
        }

        // Manual print function for backup
        function manualPrint() {
            try {
                window.print();
            } catch (error) {
                console.error('Print error:', error);
                alert('Print failed: ' + error.message);
            }
        }

        // Load customer data when page loads
        window.addEventListener('load', loadCustomerDataFromURL);
    </script>
</body>

</html>